## Module

### 1. node中require加载模块是同步的

### 2. 模块的分类

- 内置模块 核心模块 原生模块 由Nodejs提供  
  - http fs path url ......
- 文件模块
  - .js
  - .json
  - .node (C/C++编写的模块)
- 自定义模块(第三方模块)
  - mime
  - ......

### 3. require加载模块的过程

- require的是一个路径.  require的时候 如果是路径必须以 ./开头
  - `require("./database.js");` 这种情况，给的是1个文件路径，并且带了后缀名，那么就会根据这个相对路径拼出绝对路径，去加载这个文件，如果有就加载，如果没有就加载失败	。
  - `require("./database");` 是1个相对路径，但是没有写后缀名. 加载顺序:
    - 先找database.js
    - 再找database.json
    - 再找database.node
    - 再找database这个文件夹 认为它是1个第三方模块
      - 找 package.json
      - 找main字段，入口文件.
      - 查找入口文件，加载。
      - 如果入口文件不存在，找index.js -> index.json -> index.node
- require的是一个模块名称
  - `require("mime")` 
    - 先查找是否是内置模块.
    - 当前js文件目录下，查找`node_modules`目录
      - 如果有。
        - 查找是否有这个模块。
      - 如果没有
        - 找父目录是否有这个文件夹。
        - 直到找到根目录 如果没有 就报错

### 4. 加载细节

- 一旦被加载过1次，那么第2次，直接从缓存中读取.
- 每次加载模块的时候，优先从缓存中加载 没有再走流程.
- 核心模块一开始被编译成了二进制文件，所以加载速度极快.
- 试图加载1个和 核心模块 同名的自定义模块是不会成功的
  - 自定义模块的名字不能与核心模块重名.
  - 使用路径加载.
- 核心模块只能通过模块名称来加载 使用路径的方式加载是不行的 require("./http") 是错误的
- require加载模块时使用 ./ 相对路径 永远指的是相对于当前js文件.
- 建议加载文件模块的时候，写上后缀名.